(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-299f3f6c"],{2532:function(t,e,i){"use strict";var s=i("23e7"),o=i("5a34"),n=i("1d80"),a=i("ab13");s({target:"String",proto:!0,forced:!a("includes")},{includes:function(t){return!!~String(n(this)).indexOf(o(t),arguments.length>1?arguments[1]:void 0)}})},"3c0e":function(t,e,i){},"5a34":function(t,e,i){var s=i("44e7");t.exports=function(t){if(s(t))throw TypeError("The method doesn't accept regular expressions");return t}},"7b97":function(t,e,i){t.exports=i.p+"assets/media/Hardcover.3d15bc24.mp3"},8909:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAABdklEQVQokY1SzUoDMRCeTZNt05/dthQqdu32oEfx4gMI4gvoRajgc3lSwacQ8STUixafoKeFLfTQxna72w2JzLopUtD6Qcgk3/fNkMxYo9EIpJRACAHLsrIYl+d5twBgB0HQLxQKQCkFrXXGlUoloJADTWmaglIKOp3OXa1Wu0bG8zwdBMEVcowxIwcCuWm1WuFOfd9/dBwnMyGq1Wq/2+0+IZckSaZdG+M4xmxt3/ffOednsAHO+SlyqDFmggHn/KjX633Ytn24aTJADjWoxUIQhuG5Ukr/F6gdj8cXFup/q/IX6Hw+P5ZSOpVK5Z4xtrdFH0ZR1I/j+BONb4vFAt85BYBtRlEsFp+xA3S5XGbNJ4TYhk3T9GUymTzg77VarUtK6UlOMRyGer3+PQCmNwZKqUEURTeu6+LE7AKAMa5BcVJyc9vcaq33G40GNJtNPB780O+YgJTLZXwfVnnVWgtcSqkhJhRCQJIkQ3MvpRzMZjMQQsAXc7TZuaPLdKIAAAAASUVORK5CYII="},"98d7":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"exhibition",attrs:{id:"zoomView"}},[s("div",{ref:"bookBox",staticClass:"book-box center",class:{pageIsZoom:t.pageIsZoom,active:t.moveStatus,searchPd:t.searchList.length},style:{left:t.position.x+"px",top:t.position.y+"px",transformOrigin:t.Origin.x+"px "+t.Origin.y+"px"},on:{click:t.computedChick,mousedown:function(e){return t.setMoveStatus(!0)},mouseup:function(e){return t.setMoveStatus(!1)}}},[s("div",{staticClass:"center_container",class:{first:"first"==t.pageType&&!t.isMobile,zoomOut:t.pageIsZoom},style:{width:("none"!=t.pageType||t.isMobile?t.curWidth/2:t.curWidth)+"px"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"first"!=t.pageType&&!t.pageIsZoom,expression:"pageType != 'first' && !pageIsZoom"}],staticClass:"book_btn left",on:{click:function(e){return e.stopPropagation(),t.previous(e)}}}),s("div",{attrs:{id:"flipbook"}},t._l(t.pageData.components,(function(e){return s("div",{key:e.id,staticStyle:{background:"white"}},[s("ComponentContainer",{attrs:{children:[e],boxSize:{width:t.isMobile?t.curWidth:t.curWidth/2,height:t.curHeight}}})],1)})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:"last"!=t.pageType&&!t.pageIsZoom,expression:"pageType != 'last' && !pageIsZoom"}],staticClass:"book_btn right",on:{click:function(e){return e.stopPropagation(),t.next(e)}}})])]),s("audio",{ref:"Hardcover",attrs:{src:i("7b97")}}),t.isMobile?t._e():s("div",{staticClass:"volume_box"},[s("div",{staticClass:"msg"},[t._v("键盘↑↓控制音量")]),t._v(" 媒体音量："+t._s(parseInt(100*t.$store.state.volume))+"% ")]),s("div",{staticClass:"top_utils",class:{active:t.showUtils},on:{keydown:function(t){t.stopPropagation()}}},[s("img",{staticClass:"home-icon",attrs:{src:i("8909"),alt:""},on:{click:function(e){return t.changePage(1)}}}),t.disabledSearch?t._e():s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchVal,expression:"searchVal",modifiers:{trim:!0}}],staticClass:"search-input",attrs:{type:"text",placeholder:"请输入搜索内容"},domProps:{value:t.searchVal},on:{change:t.searchFn,input:function(e){e.target.composing||(t.searchVal=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),s("div",{staticClass:"page-info"},[s("span",{staticClass:"cur-page"},[s("input",{attrs:{type:"text"},domProps:{value:t.curPageStr.join("-")},on:{change:t.changePageInput}})]),s("span",[t._v("/")]),s("span",{staticClass:"total-page"},[t._v(t._s(t.pageData.components.length))])])]),s("div",{staticClass:"search-list",class:{active:t.searchList.length},on:{click:function(t){t.stopPropagation()}}},t._l(t.searchList,(function(e){return s("div",{key:e.id,staticClass:"search-list-item",on:{click:function(i){return t.changePage(e.page+1)}}},[s("div",{staticClass:"page-index",class:{active:t.curPageStr.includes(e.page+1)}},[t._v(" "+t._s(e.page+1)+" ")]),s("div",{staticClass:"content",domProps:{innerHTML:t._s(e.content)}})])})),0)])},o=[],n=(i("ac1f"),i("5319"),i("caad"),i("2532"),i("a8be"),i("082a"),i("1fbc")),a={data:function(){return{pageData:"",pWidth:1600,pHeight:1100,isMobile:!1,zoom:1,curPage:1,pageType:"first",pageIsZoom:!1,clickComputed:!1,timer:null,position:{x:0,y:0},Origin:{x:0,y:0},moveStatus:!1,showUitlsTimer:null,showUtils:!1,disabledSearch:!1,searchVal:"",searchList:[]}},created:function(){var t=localStorage.getItem("pageData");this.pageData=t?JSON.parse(t):n["a"]},computed:{curWidth:function(){return this.pWidth*this.zoom},curHeight:function(){return this.pHeight*this.zoom},curPageStr:function(){return this.isMobile||1==this.curPage||this.curPage==this.pageData.components.length&&this.pageData.components.length%2==0?[this.curPage]:this.curPage%2==0?[this.curPage,this.curPage+1]:[this.curPage-1,this.curPage]}},mounted:function(){this.resize(),this.initBook(),window.addEventListener("keydown",this.keydown),window.addEventListener("resize",this.resize),document.addEventListener("mousewheel",this.mousewheel,!1),this.$refs.bookBox.addEventListener("mousemove",this.move)},methods:{initBook:function(){var t=this;$("#flipbook").turn({width:this.isMobile?this.curWidth/2:this.curWidth,height:this.curHeight,autoCenter:!1,acceleration:!0,gradients:!0,display:this.isMobile?"single":"double",duration:700,when:{first:function(){console.log("第一页"),t.pageType="first"},last:function(){console.log("最后一页"),t.pageType="last"},turning:function(e,i,s){console.log("翻页",i),t.curPage=i,t.Hardcover(),t.pageType="none"}}}),console.log($("#flipbook").turn("size"))},resize:function(){var t=this.$refs.bookBox.offsetWidth,e=this.$refs.bookBox.offsetHeight;document.documentElement.offsetWidth<950||document.documentElement.offsetHeight<700?(this.disabledSearch=!0,this.searchList=[],this.searchVal=""):this.disabledSearch=!1,this.searchList.length&&(t-=350,e-=350),this.isMobile=t/(t+e)<=.5,this.zoom=Math.min(t/(this.isMobile?this.pWidth/2:this.pWidth),e/this.pHeight),this.bookResize()},bookResize:function(){var t=this;this.$nextTick((function(){$("#flipbook").turn("display",t.isMobile?"single":"double"),$("#flipbook").turn("size",t.isMobile?t.curWidth/2:t.curWidth,t.curHeight)}))},next:function(){$("#flipbook").turn("next"),this.curPage=$("#flipbook").turn("page")},previous:function(){$("#flipbook").turn("previous"),this.curPage=$("#flipbook").turn("page")},Hardcover:function(){this.$refs.Hardcover&&(this.$refs.Hardcover.currentTime=0,this.$refs.Hardcover.play())},keydown:function(t){switch(t.keyCode){case 37:this.previous();break;case 38:this.$store.commit("setVolume","add");break;case 39:this.next();break;case 40:this.$store.commit("setVolume","minish");break;default:break}},mousewheel:function(t){console.log(t)},dblclick:function(t){this.showUitlsTimer&&clearTimeout(this.showUitlsTimer),this.pageIsZoom=!this.pageIsZoom,this.pageIsZoom&&(this.Origin.x=t.x-30,this.Origin.y=t.y-30)},computedChick:function(t){var e=this;this.setShowUtils(),this.timer&&clearTimeout(this.timer),this.timer=setTimeout((function(){e.clickComputed=!1}),250),this.clickComputed&&this.dblclick(t),this.clickComputed=!0},setMoveStatus:function(t){this.moveStatus=t,console.log(t,"")},move:function(t){if(!this.pageIsZoom)return this.position.x=0,void(this.position.y=0);this.moveStatus&&(this.position.x+=t.movementX,this.position.y+=t.movementY)},changePage:function(t){$("#flipbook").turn("page",t)},changePageInput:function(t){var e=parseInt(t.target.value);console.log(e),!isNaN(e)&&e<=this.pageData.components.length&&e>=1&&e!=this.curPage&&this.changePage(e)},setShowUtils:function(){var t=this;this.showUitlsTimer&&clearTimeout(this.showUitlsTimer),this.showUitlsTimer=setTimeout((function(){t.showUtils=!t.showUtils}),500)},searchFn:function(){var t=this,e="";this.searchList=[];var i=function t(i,s){for(var o=0;o<i.length;o++){var n=i[o];"Page"==n.component&&(e=o,console.log(e,"page")),s(n,e),n.children&&n.children.length&&(s(n,e),t(n.children,s))}};i(this.pageData.components,(function(e,i){"BookContent"==e.component&&(e.componentData.html=e.componentData.html.replace(/<SEARCH_P style="background:#ff9813;">/g,"").replace(/<\/SEARCH_P>/g,""),t.searchVal&&e.componentData.html.includes(t.searchVal)&&(e.componentData.html=e.componentData.html.replace(t.searchVal,'<SEARCH_P style="background:#ff9813;">'.concat(t.searchVal,"</SEARCH_P>")),t.searchList.push({id:e.id,page:i,content:e.componentData.html})))})),this.resize(),!this.searchList.length&&this.searchVal&&this.$message("暂无查询结果")}},destroyed:function(){window.removeEventListener("resize",this.resize),window.removeEventListener("keydown",this.keydown),document.removeEventListener("mousewheel",this.mousewheel),this.$refs.bookBox.removeEventListener("mousemove",this.move)}},r=a,c=(i("adc0"),i("2877")),h=Object(c["a"])(r,s,o,!1,null,null,null);e["default"]=h.exports},ab13:function(t,e,i){var s=i("b622"),o=s("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[o]=!1,"/./"[t](e)}catch(s){}}return!1}},adc0:function(t,e,i){"use strict";i("3c0e")}}]);